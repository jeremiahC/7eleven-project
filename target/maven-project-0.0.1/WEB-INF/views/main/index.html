<!DOCTYPE html>
<html lang="en"  xmlns:th="http://thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Welcome to 7 eleven</title>
    <link rel="shortcut icon" href="../../../resources/img/logo.png">
    <link href="../../../resources/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <style>
        .message{
            border-radius: 20px;
            padding: 20px;
            color: white;
        }
    </style>

</head>
<body>
    <header id="header-image">
        <!--header-->

    </header>

    <nav class="wrapper">
        <ul>
            <li><a class="nav-link" href="#">Products</a></li>
            <li><a class="nav-link active" href="#">Register</a></li>
            <li><a class="nav-link" href="#">Benefits</a></li>
            <li><a class="nav-link" href="#">Contacts</a></li>
        </ul>
    </nav>

    <section>
        <article>
            <h1>Be part of 7eleven family and enjoy exclusive benefits and rewards!</h1>
            <p>7eleven family card availability may vary on the 7eleven branch</p>
        </article>
        <div class="container">
            <label class="labels">Registration Form</label>
            <span id="close">close</span>
            <div id="message"></div>

            <form>
                <input type="hidden" id="csrf-token" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <div>
                    <label>Name</label>
                    <input class="form-input" type="text" id="user_name">
                </div>
                <div>
                    <label>Email</label>
                    <input class="form-input" type="text"  id="user_email">
                </div>
                <div>
                    <label>Mobile Number</label>
                    <input class="form-input" type="text">
                </div>

                <div>
                    <label>Date of Birth</label>
                    <select class="form-date"></select>
                    <select class="form-date"></select>
                    <select class="form-date"></select>
                </div>

                <div>
                    <label>Gender</label>
                    <input type="radio" id="female">
                    <label for="female">Female</label>
                    <input type="radio" id="male">
                    <label for="male">Male</label>
                </div>


                <div>
                    <input type="button" id="submitBtn" class="form-button" value="Submit">
                </div>
                    <img src="../../../resources/img/cards.png" alt="this is and image">

            </form>
        </div>
    </section>

    <footer>
        <div>
            <article>
                <ul>
                    <li><label >SUSPENDISSE</label></li>
                    <li><label >SUSPENDISSE</label></li>
                    <li><label >SUSPENDISSE</label></li>
                    <li><label >SUSPENDISSE</label></li>
                </ul>
            </article>
            <article>
                <ul>
                    <li>Quisque</li>
                    <li>Faucibus</li>
                    <li>Sapien</li>
                    <li>Hendrerit</li>
                </ul>
            </article>
            <article>
                <ul>
                    <li>Quisque</li>
                    <li>Faucibus</li>
                    <li>Sapien</li>
                    <li>Hendrerit</li>
                </ul>
            </article>

        </div>
    </footer>

    <script type="text/javascript" src="../../../resources/js/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="../../../resources/js/jquery.validate.js"></script>

    <script>

        $("#close").hide();
        $(document).ready(function () {
            $("#submitBtn").click(function(){

                var name  = $("#user_name").val();
                var email = $("#user_email").val();
                var csrf = $("#csrf-token").val();

                $.ajax({
                    type: "post",
                    url: "/post",
                    data: ({
                        "_csrf" : csrf ,
                        "name": name,
                        "email": email
                    }),
                    error: function(data){
                        //alert("error");
                        console.log(data);
                    },
                    success: function(data){
                        console.log(data);
                        if(data.hasErrors == true) {
                            $("#message").show();
                            //close message
                            $("#close").show().click(function () {
                                $("#message").hide();
                                $(this).hide();
                            });

                            //display message
                            var selector = $("#message");

                            selector.addClass("message").css("background-color", "#FF3835").empty();

                            for(var i = 0; i < data.errors.length; i++) {
                                selector.append("<p class='msg'>" +  data.errors[i].defaultMessage + " </p>");
                            }

                        }else{
                            $("#message").show();
                            //close message
                            $("#close").show().click(function () {
                                $("#message").hide();
                                $(this).hide();
                            });

                            //display message
                            $("#message").addClass("message")
                                    .css("background-color", "#69db5c").empty()
                                    .append("<p>" + data.fullname + " has succesfully registered</p>");

                        }

                    }
                });

            });
        });

    </script>
</body>
</html>